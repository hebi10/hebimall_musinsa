# Firebase Storage êµ¬ì¡° ê°œì„  ë¬¸ì„œ

## ğŸ¯ ê°œìš”
ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ Firebase Storage êµ¬ì¡°ë¥¼ ì¬ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

## ğŸ“ ìƒˆë¡œìš´ Storage êµ¬ì¡°

### ì´ì „ êµ¬ì¡°
```
products/
  â””â”€â”€ {productId}/
      â””â”€â”€ images/
          â”œâ”€â”€ image1.jpg
          â”œâ”€â”€ image2.jpg
          â””â”€â”€ ...
```

### ìƒˆë¡œìš´ êµ¬ì¡°
```
images/
  â”œâ”€â”€ tops/          (ìƒì˜)
  â”‚   â”œâ”€â”€ {productId}/
  â”‚   â”‚   â”œâ”€â”€ 1703123456_0.jpg
  â”‚   â”‚   â”œâ”€â”€ 1703123456_1.jpg
  â”‚   â”‚   â””â”€â”€ ...
  â”‚   â””â”€â”€ {productId2}/
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ bottoms/       (í•˜ì˜)
  â”‚   â””â”€â”€ {productId}/
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ shoes/         (ì‹ ë°œ)
  â”‚   â””â”€â”€ {productId}/
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ accessories/   (ì•¡ì„¸ì„œë¦¬)
  â”‚   â””â”€â”€ {productId}/
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ bags/          (ê°€ë°©)
  â”‚   â””â”€â”€ {productId}/
  â”‚       â””â”€â”€ ...
  â””â”€â”€ others/        (ê¸°íƒ€)
      â””â”€â”€ {productId}/
          â””â”€â”€ ...
```

## ğŸ”§ ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. ì¹´í…Œê³ ë¦¬ë³„ ê²½ë¡œ ë§¤í•‘
```typescript
const categoryMap = {
  'ìƒì˜': 'tops',
  'í•˜ì˜': 'bottoms', 
  'ì‹ ë°œ': 'shoes',
  'ì•¡ì„¸ì„œë¦¬': 'accessories',
  'ê°€ë°©': 'bags',
  'ê¸°íƒ€': 'others'
};
```

### 2. ìƒˆë¡œìš´ ì—…ë¡œë“œ í•¨ìˆ˜
```typescript
uploadProductImages(
  files: File[],
  category: string,        // ì¹´í…Œê³ ë¦¬ (í•œê¸€)
  productId: string,       // ìƒí’ˆ ID
  onProgress?: (progress: number, fileName: string) => void
): Promise<string[]>
```

### 3. íŒŒì¼ëª… ê·œì¹™
- í˜•ì‹: `{timestamp}_{index}.{extension}`
- ì˜ˆì‹œ: `1703123456_0.jpg`, `1703123456_1.png`

## ğŸ›¡ï¸ Storage Rules

### ìƒˆë¡œìš´ ë³´ì•ˆ ê·œì¹™
```javascript
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // ìƒí’ˆ ì´ë¯¸ì§€: images/{category}/{productId}/{filename}
    match /images/{category}/{productId}/{filename} {
      // ì½ê¸°: ëª¨ë“  ì‚¬ìš©ì í—ˆìš© (ìƒí’ˆ ì´ë¯¸ì§€ëŠ” ê³µê°œ)
      allow read: if true;
      
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ í—ˆìš©
      allow write: if true; // ê°œë°œìš©, ì¶”í›„ ê´€ë¦¬ì ì¸ì¦ ì¶”ê°€
      
      // íŒŒì¼ í¬ê¸° ì œí•œ (5MB)
      allow write: if request.resource.size < 5 * 1024 * 1024;
      
      // ì´ë¯¸ì§€ íŒŒì¼ë§Œ í—ˆìš©
      allow write: if request.resource.contentType.matches('image/.*');
    }
  }
}
```

## ğŸš€ ìƒˆë¡œìš´ ê¸°ëŠ¥

### 1. íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
```typescript
validateImageFiles(files: File[]): { valid: File[]; errors: string[] }
```
- ì´ë¯¸ì§€ íŒŒì¼ í˜•ì‹ í™•ì¸
- íŒŒì¼ í¬ê¸° ì œí•œ í™•ì¸ (5MB)
- ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ

### 2. ì§„í–‰ë¥  í‘œì‹œ
- íŒŒì¼ë³„ ê°œë³„ ì§„í–‰ë¥  í‘œì‹œ
- ì‹¤ì‹œê°„ ì—…ë¡œë“œ ìƒíƒœ ëª¨ë‹ˆí„°ë§

### 3. ê²½ë¡œ íŒŒì‹± ìœ í‹¸ë¦¬í‹°
```typescript
parseStoragePath(imageUrl: string): { category: string; productId: string } | null
```
- Storage URLì—ì„œ ì¹´í…Œê³ ë¦¬ì™€ ìƒí’ˆ ID ì¶”ì¶œ
- ì´ë¯¸ì§€ ê´€ë¦¬ ë° ì‚­ì œ ì‹œ í™œìš©

## ğŸ“ ì‚¬ìš© ë°©ë²•

### ìƒí’ˆ ì¶”ê°€ ì‹œ
1. ì¹´í…Œê³ ë¦¬ ì„ íƒ (í•„ìˆ˜)
2. ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ
3. ìë™ìœ¼ë¡œ `images/{category}/{productId}/` ê²½ë¡œì— ì—…ë¡œë“œ

### ìƒí’ˆ ìˆ˜ì • ì‹œ
1. ê¸°ì¡´ ì´ë¯¸ì§€ í‘œì‹œ
2. ìƒˆ ì´ë¯¸ì§€ ì¶”ê°€ ì‹œ ë™ì¼í•œ ê²½ë¡œ êµ¬ì¡° ì‚¬ìš©
3. ê°œë³„ ì´ë¯¸ì§€ ì‚­ì œ ê°€ëŠ¥

## ğŸ ì¥ì 

### 1. ì²´ê³„ì ì¸ ê´€ë¦¬
- ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì´ë¯¸ì§€ êµ¬ë¶„
- ìƒí’ˆë³„ë¡œ í´ë” êµ¬ì„±
- ì¼ê´€ëœ íŒŒì¼ëª… ê·œì¹™

### 2. í™•ì¥ì„±
- ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬ ì‰½ê²Œ ì¶”ê°€
- ì¹´í…Œê³ ë¦¬ë³„ ì •ì±… ì ìš© ê°€ëŠ¥
- ë°±ì—… ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ìš©ì´

### 3. ì„±ëŠ¥ ìµœì í™”
- ì¹´í…Œê³ ë¦¬ë³„ ì´ë¯¸ì§€ ë¡œë”©
- CDN ìºì‹± ì „ëµ ì ìš© ê°€ëŠ¥
- ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ê°ì†Œ

### 4. ë³´ì•ˆ ê°•í™”
- ì„¸ë°€í•œ ì ‘ê·¼ ê¶Œí•œ ì œì–´
- ì¹´í…Œê³ ë¦¬ë³„ ë³´ì•ˆ ì •ì±…
- íŒŒì¼ í˜•ì‹ ë° í¬ê¸° ì œí•œ

## ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜

ê¸°ì¡´ ì´ë¯¸ì§€ê°€ ìˆë‹¤ë©´ ë‹¤ìŒ ê³¼ì •ì„ í†µí•´ ë§ˆì´ê·¸ë ˆì´ì…˜:

1. ê¸°ì¡´ ì´ë¯¸ì§€ URL ìˆ˜ì§‘
2. ìƒí’ˆì˜ ì¹´í…Œê³ ë¦¬ ì •ë³´ í™•ì¸
3. ìƒˆë¡œìš´ ê²½ë¡œë¡œ ì´ë¯¸ì§€ ë³µì‚¬/ì´ë™
4. Firestoreì˜ ì´ë¯¸ì§€ URL ì—…ë°ì´íŠ¸
5. ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **ì¹´í…Œê³ ë¦¬ ì„ íƒ í•„ìˆ˜**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ ë°˜ë“œì‹œ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì•¼ í•¨
2. **íŒŒì¼ í¬ê¸° ì œí•œ**: ìµœëŒ€ 5MBê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥
3. **ì´ë¯¸ì§€ í˜•ì‹**: JPG, PNG, GIF, WebP ë“± ì´ë¯¸ì§€ íŒŒì¼ë§Œ í—ˆìš©
4. **ê²½ë¡œ ì¼ê´€ì„±**: í•œë²ˆ ìƒì„±ëœ ê²½ë¡œëŠ” ë³€ê²½í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ê¶Œì¥

## ğŸ“Š ëª¨ë‹ˆí„°ë§

Firebase Consoleì—ì„œ ë‹¤ìŒ í•­ëª©ì„ ëª¨ë‹ˆí„°ë§:
- Storage ì‚¬ìš©ëŸ‰
- ì¹´í…Œê³ ë¦¬ë³„ ì´ë¯¸ì§€ ìˆ˜
- ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ í†µê³„
- ì—ëŸ¬ ë¡œê·¸

---

ì´ ìƒˆë¡œìš´ êµ¬ì¡°ë¥¼ í†µí•´ ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ë”ìš± ì²´ê³„ì ì´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
